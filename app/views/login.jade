!!! 5
html(lang="en")
	head
		meta(charset="utf-8")
		meta(http-equiv="X-UA-Compatible", content="IE=edge,chrome=1")
		meta(name="viewport", content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no")

		title Login to Protrada (Bananaman release)

		include partials/styles

	body.login
		#main-container
				#login-container
					h1#beta-logo.ff-icon-before alpha
					#login-content
						#login-title
							strong Please login to access
							| Protrada Alpha V3 (Bananaman)
						form#login-body(method="post", action="/login")
							fieldset.login
								#login
									input(type='text', name=everyauth.password.loginFormFieldName)
								#password
									input(type='password', name=everyauth.password.passwordFormFieldName, value=login)
								
								#submit.login-right
									input(type="submit", value="").invisible
									a.go-login.ff-icon-after(href="#") go login
									a#forgot.ff-icon-after(href="#") forgot?
						#process-error(hidden)
							h3.ff-icon-before
								| error
							span
								span
								br
								| &nbsp;

						#login-facebook.clearfix
							h3.ff-icon-before
								| login via 
								strong Facebook
							span
								| Use your facebook profile
								br
								| to create a Protrada account

		script(src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js")
		//!= CDN('/js/require/' + require_conf + '.js')

		script
			// verify that we are at the right URL
			if ( window.location.pathname !== "/login" ) {
				window.location = "/login";
			}

			// inline Javascript is bad practice, keep in DOMContentLoaded
			$( document ).ready(function() {
				$(".go-login").on( "click", function( e ) {
					e.preventDefault();
					
					$("#login-body").trigger("submit");
					
					// clean slate in case of retry
					//$("#login-container").removeClass("error");
					//$("#process-error").attr( "hidden", true );
				
					//$.jsonrpc( "user/check-login", $("#login-body").serializeJSON(), function( data ) {
					//	console.log(data);

					//	if ( data.checked === true ) {
					//		window.location = "/home";
					//	} else {
					//		$("#login-container").addClass("error");
					//		$("#process-error").removeAttr("hidden").find("span").find("span").text( data.errorMsg );
					//	}
					//});
				});
			});

		script
			var _gaq = _gaq || [];
			_gaq.push(
				[ "_setAccount", "UA-33674085-1" ],
				[ "_trackPageview" ],
				[ "_setCustomVar", 1, "Module", "login", 3 ]
			);

			(function() {
				var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
				ga.src = ( "https:" == document.location.protocol ? "https://ssl" : "http://www" ) + ".google-analytics.com/ga.js";
				var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore( ga, s );
			})();
